<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="formods">
<title>Making Modules • formods</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Making Modules">
<meta property="og:description" content="formods">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">formods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/included_modules.html">Included Modules</a>
    <a class="dropdown-item" href="../articles/making_modules.html">Making Modules</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/john-harrold/formods/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Making Modules</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/john-harrold/formods/blob/HEAD/vignettes/making_modules.Rmd" class="external-link"><code>vignettes/making_modules.Rmd</code></a></small>
      <div class="d-none name"><code>making_modules.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will provide an overview of the formods framework for
creating reproducable modules that interact with each other. Each module
has its own namespace that is mantained by using a module short name as
a prefix for functions. For example the figure generation module uses
<code>FG</code>. If you want to create a module, please submit an issue
at the <a href="https://github.com/john-harrold/formods/issues" class="external-link">formods
github repository</a> with the following information:</p>
<ul>
<li>The short name you intend to use</li>
<li>A brief description of the module</li>
<li>A list of modules it depends on</li>
</ul>
<div class="section level3">
<h3 id="current-modules">Current modules<a class="anchor" aria-label="anchor" href="#current-modules"></a>
</h3>
<ul>
<li>ASM - <a href="https://formods.ubiquity.tools" class="external-link">App State
Management</a>
</li>
<li>DW - <a href="https://formods.ubiquity.tools" class="external-link">Data
Wrangling</a>
</li>
<li>FG - <a href="https://formods.ubiquity.tools" class="external-link">Figure
Generation</a>
</li>
<li>FM - <a href="https://formods.ubiquity.tools" class="external-link">Formods</a>
</li>
<li>UD - <a href="https://formods.ubiquity.tools" class="external-link">Upload Data</a>
</li>
</ul>
<p>The current modules are in development:</p>
<ul>
<li>NCA - <a href="https://github.com/john-harrold/ruminate" class="external-link">Non-Compartmental
Analysis</a>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="formods-framework">formods framework<a class="anchor" aria-label="anchor" href="#formods-framework"></a>
</h2>
<p>To get started you can make a copy of some example files:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">copy.file</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"formods"</span>, <span class="st">"templates"</span>, <span class="st">"ZZ_module_components.R"</span><span class="op">)</span>, <span class="st">"ZZ_module_components.R"</span><span class="op">)</span></span>
<span><span class="fu">copy.file</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"formods"</span>, <span class="st">"templates"</span>, <span class="st">"ZZ_Server.R"</span><span class="op">)</span>, <span class="st">"ZZ_Server.R"</span><span class="op">)</span></span>
<span><span class="fu">copy.file</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"formods"</span>, <span class="st">"templates"</span>, <span class="st">"ZZ.yaml"</span><span class="op">)</span>, <span class="st">"ZZ.yaml"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>ZZ_module_components.R</code> - An app that can be used for
testing the module and highlighting the different UI elements that are
used within the module.</li>
<li>
<code>ZZ_Server.R</code>: A bare bones file containing the expected
functions and their minimal inputs.</li>
<li>
<code>ZZ.yaml</code>: This module configuration file contains the
the minimal elements expected, but you can add your own fields to suit
your modules needs.</li>
</ul>
<p>You can rename the <code>ZZ</code> portion of the files with the
module short name you’re using. The <code>ZZ_Server.R</code> would go in
the <code>R</code> directory in your package and the other two files
would go into <code>inst/templates</code>.</p>
<p>state fields</p>
<ul>
<li><code>yaml</code></li>
<li><code>MC</code></li>
</ul>
</div>
<div class="section level2">
<h2 id="expected-functions">Expected functions<a class="anchor" aria-label="anchor" href="#expected-functions"></a>
</h2>
<ul>
<li>
<code>ZZ_Server</code><br>
</li>
<li>
<code>ZZ_init_state</code><br>
</li>
<li>
<code>ZZ_fetch_state</code><br>
</li>
<li>
<code>ZZ_fetch_code</code> This takes as it’s first argument the
module state. When called with only this argument it should return a
character object containing all of the code needed to generate the
elements of this module represented in the app. You can assume that any
modules this one depends on will be defined previously. For example the
<code>FG</code> module will return only that code associated with
generating figures. It will be appended to the code from the
<code>UD</code> and <code>DW</code> modules that define loading the
dataset and creation of the data views. For modules where no code is
generated (e.g. <code>ASM</code>) just return <code>NULL</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="expected-ui-elements">Expected UI elements<a class="anchor" aria-label="anchor" href="#expected-ui-elements"></a>
</h2>
<ul>
<li><code>ui_zz_compact</code></li>
</ul>
</div>
<div class="section level2">
<h2 id="helper-functions-in-formods">Helper functions in formods<a class="anchor" aria-label="anchor" href="#helper-functions-in-formods"></a>
</h2>
<ul>
<li><code><a href="../reference/FM_le.html">FM_le()</a></code></li>
<li><code><a href="../reference/FM_tc.html">FM_tc()</a></code></li>
<li><code><a href="../reference/has_changed.html">has_changed()</a></code></li>
<li><code><a href="../reference/set_hold.html">set_hold()</a></code></li>
<li><code><a href="../reference/fetch_hold.html">fetch_hold()</a></code></li>
<li><code><a href="../reference/remove_hold.html">remove_hold()</a></code></li>
<li><code><a href="../reference/FM_init_state.html">FM_init_state()</a></code></li>
<li><code><a href="../reference/FM_set_mod_state.html">FM_set_mod_state()</a></code></li>
<li><code><a href="../reference/FM_fetch_mod_state.html">FM_fetch_mod_state()</a></code></li>
<li><code><a href="../reference/FM_set_ui_msg.html">FM_set_ui_msg()</a></code></li>
</ul>
</div>
<div class="section level2">
<h2 id="module-interaction">Module interaction<a class="anchor" aria-label="anchor" href="#module-interaction"></a>
</h2>
<p>Say you are using the UD module to feed data into the DW module and
the user goes back to the upload form and uploads a different data set.
This will need to trigger a reset of the Data Wrangling module as well
as tell your larger app that something has changed.</p>
<div class="section level3">
<h3 id="module-state-and-reacting-to-changes">Module state and reacting to changes<a class="anchor" aria-label="anchor" href="#module-state-and-reacting-to-changes"></a>
</h3>
<p><code>react_state[[id_UD]][["DS"]][["checksum"]]</code></p>
<ul>
<li>
<code>isgood</code> A boolean variable to indicate the general state
of the module.</li>
<li>
<code>checksum</code> A checksum that can be used to detect changes
in this module. For example in the UD module this will change if the
uploaded file or the sheet selected from a currently uploaded file
changes.</li>
<li>
<code>code_previous</code> Carries over the code from other modules
the current one depends on. For ecample the DW module would depend on
the UD model to load the data. So <code>code_previous</code> here would
contain the code to load the dataset.</li>
<li>
<code>code</code> Code to repelicate the current state of the
module.</li>
</ul>
</div>
<div class="section level3">
<h3 id="configuration-file">Configuration file<a class="anchor" aria-label="anchor" href="#configuration-file"></a>
</h3>
<style type="text/css">
.scroll-100 {
  max-height: 100px;
  overflow-y: auto;
  background-color: inherit;
}
</style>
</div>
</div>
<div class="section level2">
<h2 class="tabset" id="yaml-configuration-files">YAML configuration files<a class="anchor" aria-label="anchor" href="#yaml-configuration-files"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Harrold.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
